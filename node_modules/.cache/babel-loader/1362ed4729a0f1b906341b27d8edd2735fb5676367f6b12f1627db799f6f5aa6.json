{"ast":null,"code":"var _jsxFileName = \"/Users/friday/Documents/w2e/frontend/src/components/NearbyRestaurants.jsx\";\nimport React, { Component } from 'react';\nimport { Map, GoogleApiWrapper } from 'google-maps-react';\nimport './style.css';\nimport './mag.css';\nimport nlp from 'compromise';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass NearbyRestaurants extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      bestRestaurants: [],\n      // Initialize list of best restaurants\n      nextPageToken: null,\n      // Initialize nextPageToken state\n      showMapModal: false,\n      // State to control visibility of the map modal\n      currentLocation: null,\n      // Store current location\n      currentIndex: 0,\n      // Index for iterating list of bes restaurnats\n      showFirstPage: true,\n      // State to control visibility of the start page\n      isSpinning: false,\n      // State to control start page text spinning\n      restReady: false //\n    };\n    // Main function for best restaurant search\n    this.searchNearbyRestaurants = position => {\n      const {\n        google\n      } = this.props;\n      const {\n        latitude,\n        longitude\n      } = position.coords;\n\n      // Create a PlacesService instance\n      const placesService = new google.maps.places.PlacesService(document.createElement('div'));\n\n      // Define search parameters\n      const request = {\n        location: new google.maps.LatLng(latitude, longitude),\n        radius: 50000,\n        // Search radius in meters (adjust as needed)\n        type: 'restaurant',\n        rankBy: google.maps.places.RankBy.PROMINENCE,\n        // Sort by prominence\n        types: ['restaurant']\n      };\n\n      // ***NOT WORKING PROPERLY // Since API can only retreive 5 reviews per restaurnant at the moment, it trys to get more.\n      function fetchMoreReviews(nextPageToken) {\n        return new Promise((resolve, reject) => {\n          // Make request to fetch additional reviews using nextPageToken\n          const additionalRequest = {\n            nextPageToken: nextPageToken\n          };\n          placesService.getDetails(additionalRequest, (placeDetails, status) => {\n            if (status === google.maps.places.PlacesServiceStatus.OK) {\n              const additionalReviews = placeDetails.reviews || [];\n              const additionalReviewTexts = additionalReviews.map(review => review.text);\n              resolve(additionalReviewTexts);\n            } else {\n              console.error('Error fetching additional reviews:', status);\n              reject();\n            }\n          });\n        });\n      }\n\n      // Performs nearby search\n      placesService.nearbySearch(request, (results, status, pagination) => {\n        if (status === google.maps.places.PlacesServiceStatus.OK) {\n          // Filter restaurants with 4+ stars and 50+ reviews\n          const filteredRestaurants = results.filter(restaurant => {\n            return restaurant.rating >= 4.0 && restaurant.user_ratings_total >= 30 && !restaurant.name.toLowerCase().includes('hotel');\n          });\n\n          // Fetch category for each restaurant\n          const promises = filteredRestaurants.map(restaurant => {\n            return new Promise((resolve, reject) => {\n              // Get details for each restaurant\n              const detailsRequest = {\n                placeId: restaurant.place_id,\n                fields: ['name', 'types', 'reviews'] // Add 'reviews' field to retrieve reviews\n              };\n              placesService.getDetails(detailsRequest, (placeDetails, status) => {\n                if (status === google.maps.places.PlacesServiceStatus.OK) {\n                  // const category = placeDetails.types && placeDetails.types.length > 0 ? placeDetails.types[0] : 'Uncategorized';\n                  const topReview = placeDetails.reviews && placeDetails.reviews.length > 0 ? placeDetails.reviews[0] : 'null'; // Get the top review\n                  resolve({\n                    ...restaurant,\n                    topReview\n                  });\n                } else {\n                  console.error('Error fetching restaurant details:', status);\n                  reject(status);\n                }\n              });\n            });\n          });\n\n          // To find the representative menu, fetch reviews for each restaurant and extract text\n          const reviewPromises = filteredRestaurants.map(restaurant => {\n            return new Promise((resolve, reject) => {\n              const detailsRequest = {\n                placeId: restaurant.place_id,\n                fields: ['reviews']\n              };\n              placesService.getDetails(detailsRequest, (placeDetails, status) => {\n                if (status === google.maps.places.PlacesServiceStatus.OK) {\n                  // console.log(placeDetails.reviews); \n                  const reviews = placeDetails.reviews || [];\n                  const reviewTexts = reviews.map(review => review.text);\n                  // Check if there is a next page token and fetch more reviews if available\n                  console.log('wtf');\n                  console.log(placeDetails.next_page_token, 'nextpagetoken');\n                  if (placeDetails.next_page_token) {\n                    // Make another request to fetch more reviews\n                    fetchMoreReviews(placeDetails.next_page_token).then(additionalReviews => {\n                      resolve([...reviewTexts, ...additionalReviews]);\n                    }).catch(error => {\n                      console.error('Error fetching additional reviews:', error);\n                      resolve(reviewTexts); // Resolve with existing reviews if fetch fails\n                    });\n                  } else {\n                    console.log('nomoreview');\n                    resolve(reviewTexts); // Resolve with current reviews if no next page token\n                  }\n                  // console.log(reviews, status);\n                  // console.log(reviewTexts, status);\n                  // console.log(reviewTexts[0], status);\n\n                  resolve(reviewTexts); //not empty\n                } else {\n                  console.error('Error fetching reviews for restaurant:', status);\n                  reject();\n                }\n              });\n            });\n          });\n\n          // Resolve all promises\n          // mapping problem here?\n          Promise.all([...promises, ...reviewPromises]).then(results => {\n            // Separate the restaurant and review results based on the original promise arrays\n            const restaurantsWithReviews = results.slice(0, promises.length);\n            const reviewTextsArray = results.slice(promises.length);\n            // Update state with the filtered restaurants, category, and nextPageToken\n            this.setState({\n              bestRestaurants: restaurantsWithReviews\n            });\n            this.setState({\n              restReady: true\n            });\n            const mostRepeatedNouns = [];\n            // Process each set of reviews\n            reviewTextsArray.forEach(reviewTexts => {\n              // Initialize variables to store most repeated noun for this set of reviews\n              let mostRepeatedNoun;\n              let maxCount = 0;\n              // console.log(reviewTexts, 'nok_2');\n              // Flatten reviewTextsArray into a single array of review texts\n              const allReviewsText = [].concat.apply([], reviewTexts);\n              // console.log(allReviewsText, 'allReviewsText');\n              const giantString = allReviewsText.join(' '); // Use a space as a separator\n              // const nlp = require('compromise');\n              // console.log(giantString, 'giantString');\n              // Tokenization (split text into words)\n              const allWords = allReviewsText.flatMap(text => text.toLowerCase().split(/[\\s\\W]+/));\n              // console.log(allWords, 'allWords');\n              // Perform POS tagging\n              const doc = nlp(giantString);\n              const nouns = doc.nouns().out('array');\n\n              // Define a list of common pronouns to filter out\n              const pronounsList = [\"i\", \"you\", \"he\", \"she\", \"it\", \"we\", \"they\", \"me\", \"him\", \"her\", \"us\", \"them\", \"my\", \"your\", \"his\", \"its\", \"our\", \"their\", \"mine\", \"yours\", \"hers\", \"ours\", \"theirs\"];\n              const articlesList = [\"a\", \"an\", \"the\"];\n              const customList = [\"food\", \"place\", \"staff\", \"won\", \"bad\", \"great\"];\n              const whyNotInList = [\"and\"];\n\n              // Combine both lists into a single exclusion list\n              const exclusionList = [...pronounsList, ...articlesList, ...customList, ...whyNotInList];\n\n              // Convert the noun phrases to individual words and filter out pronouns and articles\n              const individualNouns = nouns.flatMap(phrase => phrase.toLowerCase().split(/\\W+/)).filter(word => word && !exclusionList.includes(word));\n\n              // console.log(individualNouns,'individualNouns');\n\n              // Count occurrences of each noun\n              const nounCounts = {};\n              individualNouns.forEach(noun => {\n                nounCounts[noun] = (nounCounts[noun] || 0) + 1;\n              });\n\n              // console.log('here');\n\n              // Find most repeated noun in this set of reviews\n              Object.entries(nounCounts).forEach(([noun, count]) => {\n                if (count > maxCount) {\n                  mostRepeatedNoun = noun;\n                  maxCount = count;\n                }\n              });\n\n              // console.log('here2');\n              // Store the most repeated noun for this restaurant if found\n              if (mostRepeatedNoun !== undefined) {\n                mostRepeatedNouns.push(mostRepeatedNoun); // Store just the noun, not the restaurant ID\n              } else {\n                console.warn('No most repeated noun found for restaurant:');\n              }\n            });\n\n            // Set the most repeated nouns in the state\n            this.setState({\n              mostRepeatedNouns\n            });\n          }).catch(error => {\n            console.error('Error fetching restaurant details:', error);\n          });\n        } else {\n          console.error('Error fetching nearby restaurants:', status);\n        }\n      });\n    };\n    // Function to handle button click to move to the next restaurant\n    this.moveToNextRestaurant = () => {\n      this.setState(prevState => ({\n        currentIndex: prevState.currentIndex + 1\n      }));\n    };\n    // Function to handle button click to move to the previous restaurant\n    this.handlePrevious = () => {\n      this.setState(prevState => ({\n        currentIndex: prevState.currentIndex > 0 ? prevState.currentIndex - 1 : 0\n      }));\n    };\n    // Function to handel button click to spin the w2e text and show restaruant pages\n    this.handleButtonClick = () => {\n      this.setState(prevState => ({\n        isSpinning: !prevState.isSpinning\n      }));\n      setTimeout(() => {\n        this.setState({\n          showFirstPage: false\n        });\n      }, 3000);\n    };\n    // Renders the first page\n    this.renderFirstPage = () => {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          height: '100vh'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: `${this.state.isSpinning ? 'spinning-text' : ''} custom-heading`,\n          style: {\n            marginTop: '50px',\n            fontSize: '200px'\n          },\n          children: \"W2E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"custom-body\",\n          onClick: this.handleButtonClick,\n          style: {\n            marginTop: '20px',\n            padding: '10px',\n            backgroundColor: '#ff5722',\n            color: 'black',\n            border: 'none',\n            borderRadius: '5px',\n            cursor: 'pointer'\n          },\n          children: \"Start\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 7\n      }, this);\n    };\n  }\n  // Lifecycle method called when the component is first added to the DOM\n  componentDidMount() {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(this.searchNearbyRestaurants);\n    } else {\n      console.log(\"Geolocation is not supported by this browser.\");\n    }\n\n    // Wait until the canvas elements are rendered\n    this.initializeFisheyeEffect();\n  }\n  initializeFisheyeEffect() {\n    const bg = document.getElementById('bg');\n    const c = document.getElementById('c');\n    if (!bg || !c) {\n      setTimeout(this.initializeFisheyeEffect.bind(this), 100);\n      return;\n    }\n    const ctx = c.getContext('2d');\n    const src = \"https://lumiere-a.akamaihd.net/v1/images/r_thorragnarok_header_nowplaying_47d36193.jpeg?region=0,0,2048,680\";\n    const img = new Image();\n    img.crossOrigin = \"Anonymous\";\n    img.onload = function () {\n      const w = this.width,\n        h = this.height;\n      bg.width = w;\n      bg.height = h;\n      bg.style.marginLeft = -w / 2 + 'px';\n      bg.style.marginTop = -h / 2 + 'px';\n      bg.getContext('2d').drawImage(img, 0, 0, w, h);\n      window.addEventListener(\"mousemove\", distortion);\n      window.addEventListener(\"touchmove\", distortion);\n    };\n    img.src = src;\n    function distortion(e) {\n      const cx = e.touches ? e.touches[0].clientX : e.clientX,\n        cy = e.touches ? e.touches[0].clientY : e.clientY,\n        size = 200,\n        zoom = 1;\n      c.width = size;\n      c.height = size;\n      c.style.left = cx - size / 2 + 'px';\n      c.style.top = cy - size / 2 + 'px';\n      ctx.fillRect(0, 0, size, size);\n      ctx.drawImage(bg, cx - bg.offsetLeft - 0.5 * size / zoom, cy - bg.offsetTop - 0.5 * size / zoom, size / zoom, size / zoom, 0, 0, size, size);\n      const imgData = ctx.getImageData(0, 0, size, size);\n      const pixels = imgData.data;\n      const pixelsCopy = [];\n      let index = 0;\n      for (let i = 0; i <= pixels.length; i += 4) {\n        pixelsCopy[index] = [pixels[i], pixels[i + 1], pixels[i + 2], pixels[i + 3]];\n        index++;\n      }\n      const result = fisheye(pixelsCopy, size, size);\n      for (let i = 0; i < result.length; i++) {\n        index = 4 * i;\n        if (result[i] !== undefined) {\n          pixels[index + 0] = result[i][0];\n          pixels[index + 1] = result[i][1];\n          pixels[index + 2] = result[i][2];\n          pixels[index + 3] = result[i][3];\n        }\n      }\n      ctx.putImageData(imgData, 0, 0);\n    }\n    function fisheye(srcpixels, w, h) {\n      const dstpixels = srcpixels.slice();\n      for (let y = 0; y < h; y++) {\n        const ny = 2 * y / h - 1;\n        const ny2 = ny * ny;\n        for (let x = 0; x < w; x++) {\n          const nx = 2 * x / w - 1;\n          const nx2 = nx * nx;\n          const r = Math.sqrt(nx2 + ny2);\n          if (0.0 <= r && r <= 1.0) {\n            let nr = Math.sqrt(1.0 - r * r);\n            nr = (r + (1.0 - nr)) / 2.0;\n            if (nr <= 1.0) {\n              const theta = Math.atan2(ny, nx);\n              const nxn = nr * Math.cos(theta);\n              const nyn = nr * Math.sin(theta);\n              const x2 = parseInt((nxn + 1) * w / 2);\n              const y2 = parseInt((nyn + 1) * h / 2);\n              const srcpos = parseInt(y2 * w + x2);\n              if (srcpos >= 0 && srcpos < w * h) {\n                dstpixels[parseInt(y * w + x)] = srcpixels[srcpos];\n              }\n            }\n          }\n        }\n      }\n      return dstpixels;\n    }\n  }\n  // Renders the restaurant page\n  renderRestaurantPage() {\n    const {\n      bestRestaurants,\n      currentIndex\n    } = this.state;\n    const restaurant = bestRestaurants[currentIndex] || {};\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center'\n      },\n      children: [bestRestaurants.length - 1 >= currentIndex ?\n      /*#__PURE__*/\n      // Display restaurant details\n      _jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          marginTop: '0px',\n          marginBottom: '0px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"custom-heading\",\n          style: {\n            marginTop: '50px',\n            fontSize: '100px',\n            marginBottom: '0px'\n          },\n          children: restaurant.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"convex-glass\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            viewBox: \"0 0 500 200\",\n            className: \"svg-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"defs\", {\n              children: /*#__PURE__*/_jsxDEV(\"filter\", {\n                id: \"convexLens\",\n                children: [/*#__PURE__*/_jsxDEV(\"feGaussianBlur\", {\n                  in: \"SourceGraphic\",\n                  stdDeviation: \"5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 388,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"feComponentTransfer\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"feFuncR\", {\n                    type: \"table\",\n                    tableValues: \"0 0.7 1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 390,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"feFuncG\", {\n                    type: \"table\",\n                    tableValues: \"0 0.7 1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 391,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"feFuncB\", {\n                    type: \"table\",\n                    tableValues: \"0 0.7 1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 392,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 389,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"feDisplacementMap\", {\n                  in: \"SourceGraphic\",\n                  scale: \"20\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 394,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 387,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n              x: \"50%\",\n              y: \"50%\",\n              textAnchor: \"middle\",\n              dominantBaseline: \"middle\",\n              className: \"text-content\",\n              children: this.state.mostRepeatedNouns[currentIndex]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 397,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n          width: \"400\",\n          height: \"200\",\n          children: [/*#__PURE__*/_jsxDEV(\"rect\", {\n            width: \"100%\",\n            height: \"100%\",\n            fill: \"white\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n            x: \"50%\",\n            y: \"50%\",\n            dominantBaseline: \"middle\",\n            textAnchor: \"middle\",\n            fill: \"black\",\n            fontSize: \"24\",\n            children: this.state.mostRepeatedNouns[currentIndex]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          marginTop: '0px',\n          marginBottom: '0px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"custom-heading\",\n          style: {\n            marginTop: '50px',\n            fontSize: '100px'\n          },\n          children: \"Hmm...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 435,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"custom-body\",\n          style: {\n            height: '190px',\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n            justifyContent: 'center',\n            marginTop: '20px'\n          },\n          children: \"Why don't you use Google Maps now?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 13\n      }, this)\n      // Display a paragraph if no restaurants are available\n      , /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"custom-body\",\n        onClick: this.moveToNextRestaurant,\n        style: {\n          marginTop: '0px',\n          padding: '10px',\n          backgroundColor: '#ff5722',\n          color: 'black',\n          border: 'none',\n          borderRadius: '5px',\n          cursor: 'pointer'\n        },\n        children: \"Next Restaurant\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"custom-body\",\n        onClick: this.handlePrevious,\n        disabled: currentIndex === 0,\n        style: {\n          marginTop: '20px',\n          padding: '10px',\n          backgroundColor: '#ff5722',\n          color: 'black',\n          border: 'none',\n          borderRadius: '5px',\n          cursor: 'pointer'\n        },\n        children: \"Previous\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 7\n    }, this);\n  }\n  render() {\n    const {\n      showFirstPage\n    } = this.state;\n    if (showFirstPage) {\n      return this.renderFirstPage();\n    } else {\n      // if (this.restReady) {\n      return this.renderRestaurantPage();\n      // }\n    }\n  }\n}\nexport default GoogleApiWrapper({\n  apiKey: process.env.REACT_APP_API_KEY\n})(NearbyRestaurants);","map":{"version":3,"names":["React","Component","Map","GoogleApiWrapper","nlp","jsxDEV","_jsxDEV","NearbyRestaurants","constructor","args","state","bestRestaurants","nextPageToken","showMapModal","currentLocation","currentIndex","showFirstPage","isSpinning","restReady","searchNearbyRestaurants","position","google","props","latitude","longitude","coords","placesService","maps","places","PlacesService","document","createElement","request","location","LatLng","radius","type","rankBy","RankBy","PROMINENCE","types","fetchMoreReviews","Promise","resolve","reject","additionalRequest","getDetails","placeDetails","status","PlacesServiceStatus","OK","additionalReviews","reviews","additionalReviewTexts","map","review","text","console","error","nearbySearch","results","pagination","filteredRestaurants","filter","restaurant","rating","user_ratings_total","name","toLowerCase","includes","promises","detailsRequest","placeId","place_id","fields","topReview","length","reviewPromises","reviewTexts","log","next_page_token","then","catch","all","restaurantsWithReviews","slice","reviewTextsArray","setState","mostRepeatedNouns","forEach","mostRepeatedNoun","maxCount","allReviewsText","concat","apply","giantString","join","allWords","flatMap","split","doc","nouns","out","pronounsList","articlesList","customList","whyNotInList","exclusionList","individualNouns","phrase","word","nounCounts","noun","Object","entries","count","undefined","push","warn","moveToNextRestaurant","prevState","handlePrevious","handleButtonClick","setTimeout","renderFirstPage","style","display","flexDirection","alignItems","justifyContent","height","children","className","marginTop","fontSize","fileName","_jsxFileName","lineNumber","columnNumber","onClick","padding","backgroundColor","color","border","borderRadius","cursor","componentDidMount","navigator","geolocation","getCurrentPosition","initializeFisheyeEffect","bg","getElementById","c","bind","ctx","getContext","src","img","Image","crossOrigin","onload","w","width","h","marginLeft","drawImage","window","addEventListener","distortion","e","cx","touches","clientX","cy","clientY","size","zoom","left","top","fillRect","offsetLeft","offsetTop","imgData","getImageData","pixels","data","pixelsCopy","index","i","result","fisheye","putImageData","srcpixels","dstpixels","y","ny","ny2","x","nx","nx2","r","Math","sqrt","nr","theta","atan2","nxn","cos","nyn","sin","x2","parseInt","y2","srcpos","renderRestaurantPage","marginBottom","viewBox","id","in","stdDeviation","tableValues","scale","textAnchor","dominantBaseline","fill","disabled","render","apiKey","process","env","REACT_APP_API_KEY"],"sources":["/Users/friday/Documents/w2e/frontend/src/components/NearbyRestaurants.jsx"],"sourcesContent":["import React, { Component } from 'react';\nimport { Map, GoogleApiWrapper } from 'google-maps-react';\nimport './style.css';\nimport './mag.css';\nimport nlp from 'compromise'; \n\nclass NearbyRestaurants extends Component {\n  state = {\n    bestRestaurants: [], // Initialize list of best restaurants\n    nextPageToken: null, // Initialize nextPageToken state\n    showMapModal: false, // State to control visibility of the map modal\n    currentLocation: null, // Store current location\n    currentIndex: 0, // Index for iterating list of bes restaurnats\n    showFirstPage: true, // State to control visibility of the start page\n    isSpinning : false, // State to control start page text spinning\n    restReady : false, //\n  };\n\n  // Lifecycle method called when the component is first added to the DOM\n  componentDidMount() {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(this.searchNearbyRestaurants);\n    } else {\n      console.log(\"Geolocation is not supported by this browser.\");\n    }\n\n    // Wait until the canvas elements are rendered\n    this.initializeFisheyeEffect();\n  }\n\n  initializeFisheyeEffect() {\n    const bg = document.getElementById('bg');\n    const c = document.getElementById('c');\n\n    if (!bg || !c) {\n      setTimeout(this.initializeFisheyeEffect.bind(this), 100);\n      return;\n    }\n\n    const ctx = c.getContext('2d');\n    const src = \"https://lumiere-a.akamaihd.net/v1/images/r_thorragnarok_header_nowplaying_47d36193.jpeg?region=0,0,2048,680\";\n\n    const img = new Image();\n    img.crossOrigin = \"Anonymous\";\n    img.onload = function() {\n      const w = this.width,\n        h = this.height;\n\n      bg.width = w;\n      bg.height = h;\n      bg.style.marginLeft = -w / 2 + 'px';\n      bg.style.marginTop = -h / 2 + 'px';\n\n      bg.getContext('2d').drawImage(img, 0, 0, w, h);\n\n      window.addEventListener(\"mousemove\", distortion);\n      window.addEventListener(\"touchmove\", distortion);\n    };\n    img.src = src;\n\n    function distortion(e) {\n      const cx = (e.touches ? e.touches[0].clientX : e.clientX),\n        cy = (e.touches ? e.touches[0].clientY : e.clientY),\n        size = 200,\n        zoom = 1;\n\n      c.width = size;\n      c.height = size;\n      c.style.left = cx - size / 2 + 'px';\n      c.style.top = cy - size / 2 + 'px';\n\n      ctx.fillRect(0, 0, size, size);\n      ctx.drawImage(\n        bg,\n        cx - bg.offsetLeft - 0.5 * size / zoom,\n        cy - bg.offsetTop - 0.5 * size / zoom,\n        size / zoom,\n        size / zoom,\n        0,\n        0,\n        size,\n        size\n      );\n\n      const imgData = ctx.getImageData(0, 0, size, size);\n      const pixels = imgData.data;\n      const pixelsCopy = [];\n      let index = 0;\n\n      for (let i = 0; i <= pixels.length; i += 4) {\n        pixelsCopy[index] = [pixels[i], pixels[i + 1], pixels[i + 2], pixels[i + 3]];\n        index++;\n      }\n\n      const result = fisheye(pixelsCopy, size, size);\n\n      for (let i = 0; i < result.length; i++) {\n        index = 4 * i;\n        if (result[i] !== undefined) {\n          pixels[index + 0] = result[i][0];\n          pixels[index + 1] = result[i][1];\n          pixels[index + 2] = result[i][2];\n          pixels[index + 3] = result[i][3];\n        }\n      }\n\n      ctx.putImageData(imgData, 0, 0);\n    }\n\n    function fisheye(srcpixels, w, h) {\n      const dstpixels = srcpixels.slice();\n\n      for (let y = 0; y < h; y++) {\n        const ny = ((2 * y) / h) - 1;\n        const ny2 = ny * ny;\n\n        for (let x = 0; x < w; x++) {\n          const nx = ((2 * x) / w) - 1;\n          const nx2 = nx * nx;\n          const r = Math.sqrt(nx2 + ny2);\n\n          if (0.0 <= r && r <= 1.0) {\n            let nr = Math.sqrt(1.0 - r * r);\n            nr = (r + (1.0 - nr)) / 2.0;\n\n            if (nr <= 1.0) {\n              const theta = Math.atan2(ny, nx);\n              const nxn = nr * Math.cos(theta);\n              const nyn = nr * Math.sin(theta);\n              const x2 = parseInt(((nxn + 1) * w) / 2);\n              const y2 = parseInt(((nyn + 1) * h) / 2);\n              const srcpos = parseInt(y2 * w + x2);\n              if (srcpos >= 0 && srcpos < w * h) {\n                dstpixels[parseInt(y * w + x)] = srcpixels[srcpos];\n              }\n            }\n          }\n        }\n      }\n      return dstpixels;\n    }\n  }\n\n\n  \n  \n  // Main function for best restaurant search\n  searchNearbyRestaurants = (position) => {\n    const { google } = this.props;\n    const { latitude, longitude } = position.coords;\n\n    // Create a PlacesService instance\n    const placesService = new google.maps.places.PlacesService(document.createElement('div'));\n\n    // Define search parameters\n    const request = {\n      location: new google.maps.LatLng(latitude, longitude),\n      radius: 50000, // Search radius in meters (adjust as needed)\n      type: 'restaurant',\n      rankBy: google.maps.places.RankBy.PROMINENCE, // Sort by prominence\n      types: ['restaurant']\n    };\n\n    // ***NOT WORKING PROPERLY // Since API can only retreive 5 reviews per restaurnant at the moment, it trys to get more.\n    function fetchMoreReviews(nextPageToken) {\n      return new Promise((resolve, reject) => {\n        // Make request to fetch additional reviews using nextPageToken\n        const additionalRequest = {\n          nextPageToken: nextPageToken\n        };\n        placesService.getDetails(additionalRequest, (placeDetails, status) => {\n          if (status === google.maps.places.PlacesServiceStatus.OK) {\n            const additionalReviews = placeDetails.reviews || [];\n            const additionalReviewTexts = additionalReviews.map(review => review.text);\n            resolve(additionalReviewTexts);\n          } else {\n            console.error('Error fetching additional reviews:', status);\n            reject();\n          }\n        });\n      });\n    }\n\n    // Performs nearby search\n    placesService.nearbySearch(request, (results, status, pagination) => {\n      if (status === google.maps.places.PlacesServiceStatus.OK) {\n\n        // Filter restaurants with 4+ stars and 50+ reviews\n        const filteredRestaurants = results.filter(restaurant => {\n          return restaurant.rating >= 4.0 && restaurant.user_ratings_total >= 30 &&\n           !restaurant.name.toLowerCase().includes('hotel');\n        });\n\n        // Fetch category for each restaurant\n        const promises = filteredRestaurants.map(restaurant => {\n          return new Promise((resolve, reject) => {\n            // Get details for each restaurant\n            const detailsRequest = {\n              placeId: restaurant.place_id,\n              fields: ['name', 'types', 'reviews'] // Add 'reviews' field to retrieve reviews\n            };\n            placesService.getDetails(detailsRequest, (placeDetails, status) => {\n              if (status === google.maps.places.PlacesServiceStatus.OK) {\n                // const category = placeDetails.types && placeDetails.types.length > 0 ? placeDetails.types[0] : 'Uncategorized';\n                const topReview = placeDetails.reviews && placeDetails.reviews.length > 0 ? placeDetails.reviews[0] : 'null'; // Get the top review\n                resolve({ ...restaurant, topReview });\n              } else {\n                console.error('Error fetching restaurant details:', status);\n                reject(status);\n              }\n            });\n          });\n        });\n        \n        // To find the representative menu, fetch reviews for each restaurant and extract text\n        const reviewPromises = filteredRestaurants.map(restaurant => {\n          return new Promise((resolve, reject) => {\n            const detailsRequest = {\n              placeId: restaurant.place_id,\n              fields: ['reviews']\n            };\n            placesService.getDetails(detailsRequest, (placeDetails, status) => {\n              if (status === google.maps.places.PlacesServiceStatus.OK) {\n                // console.log(placeDetails.reviews); \n                const reviews = placeDetails.reviews || [];\n                const reviewTexts = reviews.map(review => review.text);\n                // Check if there is a next page token and fetch more reviews if available\n                console.log('wtf');\n                console.log(placeDetails.next_page_token,'nextpagetoken');\n                if (placeDetails.next_page_token) {\n                  // Make another request to fetch more reviews\n                  fetchMoreReviews(placeDetails.next_page_token)\n                    .then(additionalReviews => {\n                      resolve([...reviewTexts, ...additionalReviews]);\n                    })\n                    .catch(error => {\n                      console.error('Error fetching additional reviews:', error);\n                      resolve(reviewTexts); // Resolve with existing reviews if fetch fails\n                    });\n                } else {\n                  console.log('nomoreview')\n                  resolve(reviewTexts); // Resolve with current reviews if no next page token\n                }\n                // console.log(reviews, status);\n                // console.log(reviewTexts, status);\n                // console.log(reviewTexts[0], status);\n\n                resolve(reviewTexts); //not empty\n              } else {\n                console.error('Error fetching reviews for restaurant:', status);\n                reject();\n              }\n            });\n          });\n        });\n\n        // Resolve all promises\n        // mapping problem here?\n        Promise.all([...promises, ...reviewPromises])\n          .then(results => {\n            // Separate the restaurant and review results based on the original promise arrays\n            const restaurantsWithReviews = results.slice(0, promises.length);\n            const reviewTextsArray = results.slice(promises.length);\n            // Update state with the filtered restaurants, category, and nextPageToken\n            this.setState({ bestRestaurants: restaurantsWithReviews });\n            this.setState({ restReady: true})\n            const mostRepeatedNouns = [];\n            // Process each set of reviews\n            reviewTextsArray.forEach((reviewTexts) => {\n              // Initialize variables to store most repeated noun for this set of reviews\n              let mostRepeatedNoun;\n              let maxCount = 0;\n              // console.log(reviewTexts, 'nok_2');\n              // Flatten reviewTextsArray into a single array of review texts\n              const allReviewsText = [].concat.apply([], reviewTexts);\n              // console.log(allReviewsText, 'allReviewsText');\n              const giantString = allReviewsText.join(' '); // Use a space as a separator\n              // const nlp = require('compromise');\n              // console.log(giantString, 'giantString');\n              // Tokenization (split text into words)\n              const allWords = allReviewsText.flatMap(text => text.toLowerCase().split(/[\\s\\W]+/));\n              // console.log(allWords, 'allWords');\n              // Perform POS tagging\n              const doc = nlp(giantString);\n              const nouns = doc.nouns().out('array');\n\n              // Define a list of common pronouns to filter out\n              const pronounsList = [\"i\", \"you\", \"he\", \"she\", \"it\", \"we\", \"they\", \"me\", \"him\", \"her\", \"us\", \"them\", \"my\", \"your\", \"his\", \"its\", \"our\", \"their\", \"mine\", \"yours\", \"hers\", \"ours\", \"theirs\"];\n              const articlesList = [\"a\", \"an\", \"the\"];\n              const customList = [\"food\", \"place\", \"staff\", \"won\", \"bad\", \"great\"];\n              const whyNotInList = [\"and\"]\n\n              // Combine both lists into a single exclusion list\n              const exclusionList = [...pronounsList, ...articlesList, ...customList, ...whyNotInList];\n              \n              // Convert the noun phrases to individual words and filter out pronouns and articles\n              const individualNouns = nouns.flatMap(phrase => phrase.toLowerCase().split(/\\W+/))\n                                                  .filter(word => word && !exclusionList.includes(word));\n              \n              // console.log(individualNouns,'individualNouns');\n      \n              // Count occurrences of each noun\n              const nounCounts = {};\n              individualNouns.forEach(noun => {\n                nounCounts[noun] = (nounCounts[noun] || 0) + 1;\n              });\n\n              // console.log('here');\n\n              // Find most repeated noun in this set of reviews\n              Object.entries(nounCounts).forEach(([noun, count]) => {\n                if (count > maxCount) {\n                  mostRepeatedNoun = noun;\n                  maxCount = count;\n                }\n              });\n\n              // console.log('here2');\n              // Store the most repeated noun for this restaurant if found\n              if (mostRepeatedNoun !== undefined) {\n                mostRepeatedNouns.push(mostRepeatedNoun); // Store just the noun, not the restaurant ID\n              } else {\n                console.warn('No most repeated noun found for restaurant:');\n              }\n            });\n\n          // Set the most repeated nouns in the state\n          this.setState({ mostRepeatedNouns });\n          })\n          .catch(error => {\n            console.error('Error fetching restaurant details:', error);\n          });\n      } else {\n        console.error('Error fetching nearby restaurants:', status);\n      }\n    });\n  }\n\n  // Function to handle button click to move to the next restaurant\n  moveToNextRestaurant = () => {\n    this.setState(prevState => ({\n      currentIndex: prevState.currentIndex + 1\n    }));\n  };\n\n  // Function to handle button click to move to the previous restaurant\n  handlePrevious = () => {\n    this.setState(prevState => ({\n      currentIndex: prevState.currentIndex > 0 ? prevState.currentIndex - 1 : 0\n    }));\n  }\n\n  // Function to handel button click to spin the w2e text and show restaruant pages\n  handleButtonClick = () => {\n    this.setState(prevState => ({\n      isSpinning: !prevState.isSpinning\n    }));\n    setTimeout(() => {\n      this.setState({ showFirstPage: false })\n    }, 3000);\n  };\n\n  // Renders the first page\n  renderFirstPage = () => {\n    return (\n      <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', height: '100vh' }}>\n        <h1 className={`${this.state.isSpinning ? 'spinning-text' : ''} custom-heading`} style={{ marginTop: '50px', fontSize: '200px' }}>W2E</h1>\n        <button className=\"custom-body\" onClick={this.handleButtonClick} style={{ marginTop: '20px', padding: '10px', backgroundColor: '#ff5722', color: 'black', border: 'none', borderRadius: '5px', cursor: 'pointer' }}>Start</button>\n      </div>\n    );\n  };\n\n  // Renders the restaurant page\n  renderRestaurantPage() {\n    const { bestRestaurants, currentIndex } = this.state;\n    const restaurant = bestRestaurants[currentIndex] || {};\n    return (\n      <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\n        {bestRestaurants.length - 1 >= currentIndex ? (\n          // Display restaurant details\n          <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', marginTop: '0px', marginBottom: '0px' }}>\n            <h1 className=\"custom-heading\" style={{ marginTop: '50px', fontSize: '100px', marginBottom: '0px'}}>{restaurant.name}</h1>\n            <div className=\"convex-glass\">\n              <svg viewBox=\"0 0 500 200\" className=\"svg-container\">\n                <defs>\n                  {/* Define a filter with feDistortion component for lens effect */}\n                  <filter id=\"convexLens\">\n                    <feGaussianBlur in=\"SourceGraphic\" stdDeviation=\"5\" />\n                    <feComponentTransfer>\n                      <feFuncR type=\"table\" tableValues=\"0 0.7 1\" />\n                      <feFuncG type=\"table\" tableValues=\"0 0.7 1\" />\n                      <feFuncB type=\"table\" tableValues=\"0 0.7 1\" />\n                    </feComponentTransfer>\n                    <feDisplacementMap in=\"SourceGraphic\" scale=\"20\" />\n                  </filter>\n                </defs>\n                <text x=\"50%\" y=\"50%\" textAnchor=\"middle\" dominantBaseline=\"middle\" className=\"text-content\">\n                {this.state.mostRepeatedNouns[currentIndex]}\n                </text>\n              </svg>\n            </div>\n            <svg width=\"400\" height=\"200\">\n                {/* Rectangle background */}\n                <rect width=\"100%\" height=\"100%\" fill=\"white\" />\n                {/* Text element */}\n                <text x=\"50%\" y=\"50%\" dominantBaseline=\"middle\" textAnchor=\"middle\" fill=\"black\" fontSize=\"24\">\n                  {this.state.mostRepeatedNouns[currentIndex]}\n                </text>\n              </svg>\n            {/* <div style={{ textAlign: 'center', marginTop: '0px' }}> */}\n              {/* Some text curving example */}\n              {/* <svg className=\"curved-text\" viewBox=\"0 0 425 300\">\n                <path id=\"curve\" d=\"M6,150C49.63,93,105.79,36.65,156.2,47.55,207.89,58.74,213,131.91,264,150c40.67,14.43,108.57-6.91,229-145\" />\n                <text x=\"25\">\n                  <textPath href=\"#curve\">\n                    Dangerous Curves Ahead\n                  </textPath>\n                </text>\n              </svg> */}\n              {/* DISPLAYS RESTAURANT PHOTO */}\n              {/* <div>\n                {restaurant.photos && restaurant.photos.length > 0 && (\n                  <>\n                    <a href={`https://www.google.com/maps/search/?api=1&query=${restaurant.name}&query_place_id=${restaurant.place_id}`} target=\"_blank\" rel=\"noopener noreferrer\">\n                      <img src={restaurant.photos[0].getUrl()} alt={restaurant.name} style={{ width: '200px', height: '150px', marginBottom: '5px' }} />\n                    </a>\n                  </>\n                )}\n              </div> */}\n              {/* <p className=\"lens-effect\" style={{ marginBottom: '90px', fontSize: '100px', color:'#FF9800'  }}>{this.state.mostRepeatedNouns[currentIndex]}</p>\n            </div> */}\n          </div>\n        ) : (\n            <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', marginTop: '0px', marginBottom: '0px' }}>\n              <h1 className=\"custom-heading\" style={{ marginTop: '50px', fontSize: '100px' }}>Hmm...</h1>\n              <p className=\"custom-body\" style={{ height: '190px', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', marginTop: '20px' }}>Why don't you use Google Maps now?</p>\n            </div>\n          // Display a paragraph if no restaurants are available\n        )}\n        {/* Button to move to the next restaurant */}\n        <button className=\"custom-body\" onClick={this.moveToNextRestaurant} style={{ marginTop: '0px', padding: '10px', backgroundColor: '#ff5722', color: 'black', border: 'none', borderRadius: '5px', cursor: 'pointer' }}>\n          Next Restaurant\n        </button>\n        <button className=\"custom-body\" onClick={this.handlePrevious} disabled={currentIndex === 0} style={{ marginTop: '20px', padding: '10px', backgroundColor: '#ff5722', color: 'black', border: 'none', borderRadius: '5px', cursor: 'pointer' }}>\n          Previous\n        </button>\n      </div>\n    );\n  }  \n\n\n  render() {\n    const { showFirstPage } = this.state;\n    if (showFirstPage) {\n      return this.renderFirstPage();\n    } else {\n      // if (this.restReady) {\n        return this.renderRestaurantPage();\n      // }\n    }\n  }\n}\n\n\nexport default GoogleApiWrapper({\n  apiKey: process.env.REACT_APP_API_KEY\n})(NearbyRestaurants);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}